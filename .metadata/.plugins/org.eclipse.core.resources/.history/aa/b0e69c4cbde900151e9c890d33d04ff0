import math
import string

file_name = "test.txt"
 
f = open(file_name, 'r')
 
out_file = "out.txt"
fo = open(out_file, "w")

first_line = f.readline()

m = int(first_line.split()[0])
n = int(first_line.split()[1])
dic = {}
with open(file_name, 'r') as f:
    for i, line in enumerate(f):
        if 1 <= i <= m:
            club = line.split(":")[0]
            members = line.split(":")[1]
            for member in members.split(";"):
                dic[member] = club
                
        elif i > m:
            splitted_line = line.split(";")
            club = splitted_line[1]
            member = splitted_line[0]
            if member not in dic:
                
            if dic[member] == club:
                fo.write("Yes (direct)")
            else:
                
                for ele in dic.values():
                 if member    
            else:
                fo.write("No")


